let INSTANCE_COUNT = 1;
let HIST_LEN = 0;

/**
* shelly-spotprice-se
* 
* https://github.com/david-nossebro/shelly-spotprice-se
*
* Special thanks to Jussi isotalo who created the original repo
* available here:
* https://github.com/jisotalo/shelly-porssisahko
* https://github.com/jisotalo/shelly-porssisahko-en
* 
* @license GNU Affero General Public License v3.0 
*/
const CNST={INST_COUNT:"undefined"==typeof INSTANCE_COUNT?3:INSTANCE_COUNT,HIST_LEN:"undefined"==typeof HIST_LEN?24:HIST_LEN,ERR_LIMIT:3,ERR_DELAY:120,DEF_INST_ST:{chkTs:0,st:0,str:"",cmd:-1,configOK:0,fCmdTs:0,fCmd:0},DEF_CFG:{COM:{g:"SE3",vat:25,day:0,night:0,names:[]},INST:{en:0,mode:0,m0:{c:0},m1:{l:0},m2:{p:24,c:0,l:-999,s:0,m:999,ps:0,pe:23,ps2:0,pe2:23,c2:0},b:0,e:0,o:[0],f:0,fc:0,i:0,m:60,oc:0}}};let _={s:{v:"4.0.0",dn:"",configOK:0,timeOK:0,errCnt:0,errTs:0,upTs:0,tz:"+02:00",tzh:0,enCnt:0,p:[{ts:0,now:0,low:0,high:0,avg:0},{ts:0,now:0,low:0,high:0,avg:0}]},si:[CNST.DEF_INST_ST],p:[[],[]],h:[],c:{c:CNST.DEF_CFG.COM,i:[CNST.DEF_CFG.INST]}},_i=0,_j=0,_k=0,_inc=0,_cnt=0,_start=0,_end=0,cmd=[],prevEpoch=0,loopRunning=!1;function getKvsKey(e){let t="sptprc-se";return t=0<=e?t+"-"+(e+1):t}function isCurrentHour(e,t){t-=e;return 0<=t&&t<3600}function limit(e,t,n){return Math.min(n,Math.max(e,t))}function epoch(e){return Math.floor((e?e.getTime():Date.now())/1e3)}function getDate(e){return e.getDate()}function updateTz(e){let t=e.toString(),n=0;"+0000"==(t=t.substring(3+t.indexOf("GMT")))?(t="Z",n=0):(n=+t.substring(0,3),t=t.substring(0,3)+":"+t.substring(3)),t!=_.s.tz&&(_.s.p[0].ts=0),_.s.tz=t,_.s.tzh=n}function log(e){console.log("shelly-spotprice-se: "+e)}function reqLogic(){for(let e=0;e<CNST.INST_COUNT;e++)_.si[e].chkTs=0}function updateState(){var e=new Date,t=(_.s.timeOK=null!=Shelly.getComponentStatus("sys").unixtime&&2e3<e.getFullYear(),_.s.dn=Shelly.getComponentConfig("sys").device.name,epoch(e));for(_.s.timeOK&&300<Math.abs(t-prevEpoch)&&(log("Time changed 5 min+ -> refresh"),_.s.p[0].ts=0,_.s.p[0].now=0,_.s.p[1].ts=0,_.p[0]=[],_.p[1]=[]),prevEpoch=t,_.s.enCnt=0,_i=0;_i<CNST.INST_COUNT;_i++)_.c.i[_i].en&&_.s.enCnt++;!_.s.upTs&&_.s.timeOK&&(_.s.upTs=epoch(e))}function getConfig(r){var e=getKvsKey(r);Shelly.call("KVS.Get",{key:e},function(t,e,n){r<0?_.c.c=t?JSON.parse(t.value):{}:_.c.i[r]=t?JSON.parse(t.value):{},"function"==typeof USER_CONFIG&&USER_CONFIG(r,!0);{t=r;var s=function(e){r<0?_.s.configOK=e?1:0:(log("config for #"+(r+1)+" read, enabled: "+_.c.i[r].en),_.si[r].configOK=e?1:0,_.si[r].chkTs=0),loopRunning=!1,Timer.set(500,!1,loop)};let e=0;if(CNST.DEF_CFG.COM||CNST.DEF_CFG.INST){var o,i=t<0?CNST.DEF_CFG.COM:CNST.DEF_CFG.INST,c=t<0?_.c.c:_.c.i[t];for(o in i)if(void 0===c[o])c[o]=i[o],e++;else if("object"==typeof i[o])for(var p in i[o])void 0===c[o][p]&&(c[o][p]=i[o][p],e++);t>=CNST.INST_COUNT-1&&(CNST.DEF_CFG.COM=null,CNST.DEF_CFG.INST=null),0<e?(t=getKvsKey(t),Shelly.call("KVS.Set",{key:t,value:JSON.stringify(c)},function(e,t,n,s){t&&log("failed to set config: "+t+" - "+n),s(0==t)},s)):s(!0)}else s(!0)}})}function loop(){try{if(!loopRunning)if(loopRunning=!0,updateState(),_.s.configOK)if(pricesNeeded(0))getPrices(0);else if(pricesNeeded(1))getPrices(1);else{for(let e=0;e<CNST.INST_COUNT;e++)if(!_.si[e].configOK)return void getConfig(e);for(let e=0;e<CNST.INST_COUNT;e++)if(function(e){var t=_.si[e],n=_.c.i[e];if(1!=n.en)return void(_.h[e]=[]);var e=new Date,s=new Date(1e3*t.chkTs);return 0==t.chkTs||s.getHours()!=e.getHours()||s.getFullYear()!=e.getFullYear()||0<t.fCmdTs&&t.fCmdTs-epoch(e)<0||0==t.fCmdTs&&n.m<60&&e.getMinutes()>=n.m&&t.cmd+n.i==1}(e))return void Timer.set(500,!1,logic,e);"function"==typeof USER_LOOP?USER_LOOP():loopRunning=!1}else getConfig(-1)}catch(e){log("error at main loop:"+e),loopRunning=!1}}function pricesNeeded(e){var t=new Date;let n=!1;return n=1==e?_.s.timeOK&&0===_.s.p[1].ts&&14<=t.getHours():((e=getDate(new Date(1e3*_.s.p[0].ts))!==getDate(t))&&(_.s.p[1].ts=0,_.p[1]=[]),_.s.timeOK&&(0==_.s.p[0].ts||e)),_.s.errCnt>=CNST.ERR_LIMIT&&epoch(t)-_.s.errTs<CNST.ERR_DELAY?n=!1:_.s.errCnt>=CNST.ERR_LIMIT&&(_.s.errCnt=0),n}function getPrices(a){log("Fetching prices for "+_.c.c.g);try{log("fetching prices for day "+a);let g=new Date,e=(updateTz(g),g);var t=1+(e=1===a?new Date(g.getFullYear(),g.getMonth(),1+g.getDate()):e).getMonth(),s=(t<10?"0":"")+t,o=(e.getDate()<10?"0":"")+e.getDate();let n={url:"https://www.elprisetjustnu.se/api/v1/prices/"+e.getFullYear()+"/"+s+"-"+o+"_"+_.c.c.g+".json",timeout:5,ssl_ca:"*"};log("Request url: "+n.url),e=null,Shelly.call("HTTP.GET",n,function(e,t,s){n=null;try{if(0!==t||null==e||200!==e.code||!e.body)throw Error(t+"("+s+") - "+JSON.stringify(e));{e.headers=null,s=e.message=null,_.p[a]=[],_.s.p[a].avg=0,_.s.p[a].high=-999,_.s.p[a].low=999;var o=JSON.parse(e.body);e.body=null;let n=0;for(let t=0;t<o.length;t++){var i=o[t];let e=i.SEK_per_kWh;var c,p=new Date(i.time_start.slice(0,-5)),r=p.getHours(),l=Math.floor(p.getTime()/1e3);0<e&&(c=(100+_.c.c.vat)/100,e*=c),e+=6<=r&&r<22?_.c.c.day:_.c.c.night,_.p[a].push([l,e]),_.s.p[a].high<e&&(_.s.p[a].high=e),_.s.p[a].low>e&&(_.s.p[a].low=e),n+=e}if(e=null,_.s.p[a].avg=0<o.length?n/o.length:0,_.s.p[a].ts=epoch(g),_.p[a].length<23)throw Error("invalid data received")}}catch(t){log("error getting prices: "+t),_.s.errCnt+=1,_.s.errTs=epoch(),_.s.p[a].ts=0,_.p[a]=[]}0==a&&reqLogic(),loopRunning=!1,Timer.set(500,!1,loop)})}catch(e){log("error getting prices: "+e),_.s.errCnt+=1,_.s.errTs=epoch(),_.s.p[a].ts=0,_.p[a]=[],0==a&&reqLogic(),loopRunning=!1,Timer.set(500,!1,loop)}}function logic(p){try{"function"==typeof USER_CONFIG&&USER_CONFIG(p,!1),cmd[p]=!1;var e,t,n=new Date;updateTz(n),!function(){if(_.s.timeOK&&0!=_.s.p[0].ts){var t=epoch();for(let e=0;e<_.p[0].length;e++)if(isCurrentHour(_.p[0][e][0],t))return _.s.p[0].now=_.p[0][e][1];_.s.timeOK=!1,_.s.p[0].ts=0,_.s.errCnt+=1,_.s.errTs=epoch()}else _.s.p[0].ts,_.s.p[0].now=0}();let i=_.si[p],c=_.c.i[p];function s(e){if(null==e)loopRunning=!1;else if(cmd[p]!=e&&(i.st=12),cmd[p]=e,c.i&&(cmd[p]=!cmd[p]),log("logic for #"+(p+1)+" done, cmd: "+e+" -> output: "+cmd[p]),1==c.oc&&i.cmd==cmd[p])log("outputs already set for #"+(p+1)),i.cmd=cmd[p]?1:0,i.chkTs=epoch(),loopRunning=!1;else{let s=0,o=0;for(let e=0;e<c.o.length;e++)!function(e,o,i){e="{id:"+o+",on:"+(cmd[e]?"true":"false")+"}",Shelly.call("Switch.Set",e,function(e,t,n,s){0!=t&&log("setting output "+o+" failed: "+t+" - "+n),i(0==t)},i)}(p,c.o[e],function(e){if(s++,e&&o++,s==c.o.length){if(o==s){if(i.cmd!=cmd[p]){for(var t=p,n=0<_.s.enCnt?CNST.HIST_LEN/_.s.enCnt:CNST.HIST_LEN;0<CNST.HIST_LEN&&_.h[t].length>=n;)_.h[t].splice(0,1);_.h[t].push([epoch(),cmd[t]?1:0,_.si[t].st])}i.cmd=cmd[p]?1:0,i.chkTs=epoch(),Timer.set(500,!1,loop)}loopRunning=!1}})}}0===c.mode?(cmd[p]=1===c.m0.c,i.st=1):_.s.timeOK&&0<_.s.p[0].ts&&getDate(new Date(1e3*_.s.p[0].ts))===getDate(n)?1===c.mode?(cmd[p]=_.s.p[0].now<=("avg"==c.m1.l?_.s.p[0].avg:c.m1.l),i.st=cmd[p]?2:3):2===c.mode&&(cmd[p]=function(e){var t=_.c.i[e],n=(t.m2.ps=limit(0,t.m2.ps,23),t.m2.pe=limit(t.m2.ps,t.m2.pe,24),t.m2.ps2=limit(0,t.m2.ps2,23),t.m2.pe2=limit(t.m2.ps2,t.m2.pe2,24),t.m2.c=limit(0,t.m2.c,0<t.m2.p?t.m2.p:t.m2.pe-t.m2.ps),t.m2.c2=limit(0,t.m2.c2,t.m2.pe2-t.m2.ps2),[]);for(_inc=t.m2.p<0?1:t.m2.p,_i=0;_i<_.p[0].length;_i+=_inc)if(!((_cnt=-2==t.m2.p&&1<=_i?t.m2.c2:t.m2.c)<=0)){var s=[];for(_start=_i,_end=_i+t.m2.p,t.m2.p<0&&0==_i?(_start=t.m2.ps,_end=t.m2.pe):-2==t.m2.p&&1==_i&&(_start=t.m2.ps2,_end=t.m2.pe2),_j=_start;_j<_end&&!(_j>_.p[0].length-1);_j++){var o=1<<_j;(t.f&o)==o&&(t.fc&o)!=o||s.push(_j)}if(t.m2.s){for(_avg=999,_startIndex=0,_j=0;_j<=s.length-_cnt;_j++){for(_sum=0,_k=_j;_k<_j+_cnt;_k++)_sum+=_.p[0][s[_k]][1];_sum/_cnt<_avg&&(_avg=_sum/_cnt,_startIndex=_j)}for(_j=_startIndex;_j<_startIndex+_cnt&&_j<s.length;_j++)n.push(s[_j])}else{for(_j=0,_k=1;_k<s.length;_k++){var i=s[_k];for(_j=_k-1;0<=_j&&_.p[0][i][1]<_.p[0][s[_j]][1];_j--)s[_j+1]=s[_j];s[_j+1]=i}for(_j=0;_j<_cnt;_j++)n.push(s[_j])}if(-1==t.m2.p||-2==t.m2.p&&1<=_i)break}let c=epoch(),p=!1;for(let e=0;e<n.length;e++)if(isCurrentHour(_.p[0][n[e]][0],c)){p=!0;break}return p}(p),i.st=cmd[p]?5:4,!cmd[p]&&_.s.p[0].now<=("avg"==c.m2.l?_.s.p[0].avg:c.m2.l)&&(cmd[p]=!0,i.st=6),cmd[p])&&_.s.p[0].now>("avg"==c.m2.m?_.s.p[0].avg:c.m2.m)&&(cmd[p]=!1,i.st=11):_.s.timeOK?(i.st=7,e=1<<n.getHours(),(c.b&e)==e&&(cmd[p]=!0)):(cmd[p]=1===c.e,i.st=8),_.s.timeOK&&0<c.f&&(t=1<<n.getHours(),(c.f&t)==t)&&(cmd[p]=(c.fc&t)==t,i.st=10),cmd[p]&&_.s.timeOK&&n.getMinutes()>=c.m&&(i.st=13,cmd[p]=!1),_.s.timeOK&&0<i.fCmdTs&&(0<i.fCmdTs-epoch(n)?(cmd[p]=1==i.fCmd,i.st=9):i.fCmdTs=0),"function"==typeof USER_OVERRIDE?USER_OVERRIDE(p,cmd[p],s):s(cmd[p])}catch(e){log("error running logic: "+JSON.stringify(e)),loopRunning=!1}}let _avg=999,_startIndex=0,_sum=0;log("v."+_.s.v),log("URL: http://"+(Shelly.getComponentStatus("wifi").sta_ip??"192.168.33.1")+"/script/"+Shelly.getCurrentScriptId()),_.c.i.pop(),_.si.pop();for(let e=0;e<CNST.INST_COUNT;e++)_.si.push(Object.assign({},CNST.DEF_INST_ST)),_.c.i.push(Object.assign({},CNST.DEF_CFG.INST)),_.c.c.names.push("-"),_.h.push([]),cmd.push(!1);CNST.DEF_INST_ST=null,prevEpoch=epoch(),HTTPServer.registerEndpoint("",function(n,s){try{if(loopRunning)return n=null,s.code=503,void s.send();var o=function(e){var t={},n=e.split("&");for(let e=0;e<n.length;e++){var s=n[e].split("=");t[s[0]]=s[1]}return t}(n.query),i=parseInt(o.i);n=null;let e="application/json",t=(s.code=200,!0);var c="text/html",p="text/javascript";if("s"===o.r)updateState(),0<=i&&i<CNST.INST_COUNT&&(s.body=JSON.stringify({s:_.s,si:_.si[i],c:_.c.c,ci:_.c.i[i],p:_.p})),t=!1;else if("c"===o.r)updateState(),0<=i&&i<CNST.INST_COUNT?s.body=JSON.stringify(_.c.i[i]):s.body=JSON.stringify(_.c.c),t=!1;else if("h"===o.r)0<=i&&i<CNST.INST_COUNT&&(s.body=JSON.stringify(_.h[i])),t=!1;else if("r"===o.r){if(0<=i&&i<CNST.INST_COUNT)log("config changed for #"+(i+1)),_.si[i].configOK=!1;else{log("config changed");for(let e=0;e<CNST.INST_COUNT;e++)_.si[e].configOK=!1}_.s.configOK=!1,reqLogic(),loopRunning||(loopRunning=!0,getConfig(i)),_.s.p[0].ts=0,_.s.p[1].ts=0,s.code=204,t=!1}else"f"===o.r&&o.ts?(0<=i&&i<CNST.INST_COUNT&&(_.si[i].fCmdTs=+(""+o.ts),_.si[i].fCmd=+(""+o.c),_.si[i].chkTs=0),s.code=204,t=!1):o.r?"s.js"===o.r?(s.body=atob("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"),e=p):"s.css"===o.r?(s.body=atob("H4sIAAAAAAAACpVW247bNhD9lUEWARLHsiXvJY6ELtqm2QBBExQo2peiD5Q0khhTJEGOfImxn5Nf2B/wjxWkLtZ6vQj6YljiDGfmnJkzmk8mMAFboRC7wGpF2vAMA4vg3ldE2sbzecmpatJZpup5ztY8D6SyFlOj5s95/qkx40wAVUyuLJCCT421HLhVxISCTaUgM8gIc6AKQRlecskEGNQKJsDWjAuWCoQKDcbnc/na3dZnoZWxlltWrdT/dghQ+sR/5xlKizF8/PIX/FIUaBR8RImGCfijSQXPehNYX85CmMxhAntI1Taw/BuXZQypMjmaIFXbBO4hVfluCgz2kCmhTAwXd7/dfbj70J85Z5atSqMamcdwEYaLX6+uExBcYlAhLyuKIZpdYZ1AoSS5MBhDOHs3vClYzcUuhr/R5EyyBGq2DTY8pyqGq3fG2XVPURi+dMem5DKGEFhDKgHN8txnfq23EIXa531BnATCfhy0S6P1D1JFpGrvlRyLu3v/dvHeX5ApvXvsH86Wzp8JXsrAoihiKARuA5R5AoRbCvxRDMaV7S6ZFWILe8i51YLtWnP/nlhqYQ9aWU5cORcUjPgak1M4bxh7O7jEcYqFMjjtH1lBaDw5klBSDC9eJMdw5Fpw5DxYC2TGMU1Vf+oqFYpRDAKLNneyU5hV4/SlksN1gWApivFpKlS2OmF+MXt77TAbOAohmi3cm67NTGent2CV4Lkr+apYpglkjbGOE624JDRD3K5U2D/uiiOULLVKNIQJfAu4zHEbQ5QAKX1Mx9UYQzjKK/J99gj7oiiOjdH3tdIs47Tzzh6jOKswW2H+5hEoP76orf/MPf6KNyelDmGjUVWL1lXpMQul4XnifwPCWgtGGGRKNLW0MUSF8UPj/nhnq+UIyNnCo3Ac2/Z5SNU/dzyRYdJqZlDSQOaxxrZru9ekdHA6YD39LOeNjeHaUcgkr1nLocsrsr6XmAEuCy65Y3Qok0vfZ13P3cPPK9wVhtVooa3JdQXs2zQLZeoYjCJG+OryJsyxfA33cN8OyCzLbslp2S2ZW8rjghtLQVZxkU9hlpbTzszWQGZ82qvDpsMrVSJPYI2GeMZELwak9PNDXYhtUCvHtPATiNsg5wazThTUxtdWY87Zq7EsLkO9fQ378yp140gb61E70p3u+UEIlno76p4ftEtveQuxpKot/tWliz+fwGe24rL0a/DS5NA6Q6nc1pS4JU/iZN7GaE9jiGAOQZQMFNRjBqZwka5un9OXR1N/1v+Eo67ubuZd3ce+9PM3bLx2IYSja58yPvaNnqrWDzltETg1vM35eki1S6FL4hjTOhHwIjqeOMG0W/j9v6cAHbM+m/F4fbZEZ25uRu2T4SDABR8L78sENhUn9Jmh2w8bw7Q33ETLcGS57C+vKQqPnLQodivb4RF1iHmhc+bmegyLX/Fhp5m1uD5lt4+STuHCBln9zIieavE9cKkb+od2Gn9KGyIl/z39dIge74cngjafwMedECjLRkDKVqVpZO6+r06DuZE5PJhVKg7fPcxQHB4MrJQkwyw5lzNsYZiGi6X3/nL4XiqC2l3CDIILuGJy5DnI6pXDwwX82qwYVIcHI53VQPnSfTHd9EZoQDSFv+fJ8j2DopfWbueeAuN2hQVkrh+7+HB4WKMpD99l6SKcwzyu1Np/oJzBeQTA577yNc+hdfEXDjK9P/Op2XViL2dHSXc9MgBy6bA43/u2qWtmnNg+/TL5D9JmFQyIDAAA"),e="text/css"):"status"===o.r?(s.body=atob("H4sIAAAAAAAACpWSzU7DMBCEX8XKCSrl74DEwfUFTggEEk/geB3kyvYGe5OUt0f5qVugRXCxZH2zM7OWOcnGaqasjHGbOaZUJjgFwQnEvR6M0kx6YAo9BbScgBnYxhz8QbWOjvVtJZ576npiHsckVA7EI0ow/q0oiqNzVMF0ZNAnZaQU/BKm3FMbj2OiTwg6AYegE3klSUdkfIuCl/OCgoMZDlu2ds9au88dNrlCm32BpCZWMxdufgBHdZUJ3iwFIyME+cHLRvASzCD48pZzeGeqs9mnLnfLo16wWQZIrX4ndovqXGf7l84OQ8DxUu36H7V/daq/F17O2Hdis8FBh2BA83K6z0nz1JDWTvr5o4ig3x/iVUayySNJ6mOxi9k1L1f8Ce8QLX7HAgAA"),e=c):"status.js"===o.r?(s.body=atob("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"),e=p):"history"===o.r?(s.body=atob("H4sIAAAAAAAACmWNOw7CMBBEr2K5giJY6TdbUdHQcAH/AoscHLybKLk9IgSElGaKefOBQKPyyTI3uk2TatNUddlVPieN8AfFv1mtEcS6FBGkIEj4YeWuGi/UxY15HqQfZGMfI/tCvVB+gFnGXA6zotBwdSMWBLM+mUDjVz8dLPF54p0W65ZsLvPhznoPZuUvUGxSH9cAAAA="),e=c):"history.js"===o.r?(s.body=atob("H4sIAAAAAAAAClWSUW/TMBDHv4p3KsgmabZR8dLUqYAx7WFs0hqeooi57qW18OxiXzZVWb47Sgqok/xwtny/++tndxaJRVnVufYuEltLkkX3O3KI052JBCIzzmG4Kb/fSlhQKBa0YdrbuFdOzoo7z4ZrPhwW57QpFucUCujzZxWYlioenGYDcNgHeYrNKRw603B6fXWttVJGUoQiILXBsTUXuWk4kFpP//JBSqXJPGOp1mIEYqqkelGG2BbpSpHiPx5uVwksg9y9NxIS4yKNHJX5X2KYdsajVNlGkRKZRbel3cnEHm1EZhr+6WJ2JqXKtN+8SRROXUDe+MCR+YbFLPpAnFMahCxCdVFPqbqoxTGmO3qD1Ek+rEQ+jg6tilFCYwiKSdf48KSoNE/IHb6wK0XIL3H2AUdOP8p9FMnYGelgUYL21of5pMPqsl7CNiA6mEPADfQD8Xh839K+JXZ/B/P/9fU1vAEWk25Vfi6//VyVDxVWH+t6mQXcW6WRA+OtI2PZuyggBfgXJYHjU586SaTr+14r0jtOohs+lLeYYQg+cBLpqT7q+1xzkX79ssr2bdxxLfo/Hd7yEYwCAAA="),e=p):"config"===o.r?(s.body=atob("H4sIAAAAAAAACpVWXW/iOBT9K1ZWq2kfAsRlqwoFSyzDbJktpGro9tk4F+LFsVPbgWF//SokgSSUfrwg5Ht97sm5X/YjvkU8GrLV2hWICWrM0DLyoGjE5brT6fjdiG+Jf3JDxu4FDCNuUkH3A6kkFObismMZWjqFz0pJ6xr+Hwy8DoaEjIPZLJijcLJYTOd/hSW0pUsB1e0EMeYQ32ri24iMVSat3ud/fQMCmM1JrImvUsuVRFsqMhiGE4+EO4hAoqtw0vOu22ZcN+Mz803dfHNm7tfN/Wu/WzCpSJbMd95dj/wzWhy4cplmB6pbalEuwPCGoN+rr1poKs0KNFoBmPygd+tiPECnaxHdH6/5JqWyDJJqzsDNJLeEdTcvsd/NjXX5E+v1CMZu77aOJ/k6tl9CLFLTPeSmnd48xjs5ni+eggf0WxElrxlOmqiXE17XciJzt+igp6BLEJWsdp/CkMXANkv1Kw8AkqBg3g1+/PC7pWep9Jwm0EyIPNpmKoJWYSUqAtLOLwljEGKPVGbTzJomnMqsKXTtH/1fNLfQcD9FUKxVuz0yEju6N81TjwTSZTGVazijM1bSaiVQwmVmocUn4fKY5oTL6s5UbkHbUswLKnK5Pcb4k7JNlqJYZToPkJuXm6N1koBeg2T7z+RG60vJCbagNY/KT4jAUi5MVcbiD+KbLEmo3pMwVrtuzKNci/KorCEeDVdxVUkmOVSmcyrbbgn6ZiGXVUxmo/nz6AHNgu+TL9VncEjwJyRIei5LojMV3qH0+DQdT9DDdDZdfInSY97MSPCE21ZZeK7gyUcDIJz83RgBlwmO7yejx0m4QPfB89PHc7zOccETQClorqJ292E3Bd3qD9wnuB+3ugMTD7fO7shd6+SW3LZO+qSNdENuWieYtJFdj7DMWJWgK68k3loRLj564NLDnNZEQ+2Y2Pz7dd7Zg0poq6uqxy4revwA18ohdlNTpXDQ6yEXNY1QM1Y9dq8yjVi+Rc/AmDxthLjJAddIIPwGDfwuD9wkcgZ8IvUGOJMWN3gVMxheM5CWU/HeCEuwa16P86UYrEjJs44o4Msbgief7Yhqc9BfHZS+2WsN5E/jXl6zTk0cQ7dQfPMys/b0QKFbILVX2tmePjy7RvPv4ZmTZRX86fHQiJDPV6UZlKGcGZUZFUiVk9sh/lJ/AKEkE5xtht92XEZq11EpyCun61x/KzHL9foCy+epc3x4HH4N0zy1RMPrT3PlWLp0mZIrvu78a5y8wQrz/zb57MjDCgAA"),e=c):"config.js"===o.r?(s.body=atob("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"),e=p):s.code=404:(s.body=atob("H4sIAAAAAAAACqVTTW/bMAz9K5p2SbDYXm/DKqmHNtiwa4FeB0ViYq6KpImMg2DYfx/8kbVu163ALrRJPj4+PdnqjU+OTxla3gej+iiCjTsN0ag9sBWutYWA9YG31QejGDmAuc2Jc0EH4natmrE2wqPdg+4QjjkVFi5FhshaHtFzqz106KAakhVGZLShImcD6AtplMdOuGCJNKc8puj1HzZOHcoYpwHK0ajGY3eOQyAI4LiHYiQ2KmXGFEVnwwH0e3OdIpcUxNsL1YzQR9P9lEv5ZJQVbYGtbpkzfWyaHXJ72NQu7RtvO/RVTESwKamhFkI4VXSWWhEItmUHrL9ugo335tMwKwrkpBr7TPH59HZDT3KjMOYDi/6qdLEe0+i0HRyym4rY8oGEa8Hdg9fT80xARqhgNxDENpUZ/rygGtrmdiirZszmGqrpNgdnqgeSvxzjn7JbJE7l9LLOJ4DfQj+P9dcqnWj+R6pLcYu7l5XO+w+OAjPG3as9HWnmQsdIrmBm41IkFjfrO33E6NOxDsnZ/ruuU8EdxhqjCwcPtJB9J7SJWC4vA7Dw2id32EPklStgGdYB+kyDNr6elRawXNmcIfrrFoMfEZvkT/Wjag8q8P0L9e0fnS2C9JxFjqLl8pJqKk7frO+u4KO8Klq+g7pADtbBQvYHlyspZzsXtPy5cvSMMmC8l8tLR1QXCFoSnwJQC8Cyh9fD39ovklQ7IjmsG19n9I5okr+QVH8juVTN5PEv6C6PuxcFAAA="),e=c);s.headers=[["Content-Type",e]],t&&s.headers.push(["Content-Encoding","gzip"])}catch(e){log("server error: "+e),s.code=500}s.send()}),Timer.set(1e4,!0,loop),loop();
//end

